---
layout: post
title: "DevOps 基礎概念與實踐"
date: 2018-11-12 09:30:00 +0800
categories: [DevOps, 自動化]
tags: [DevOps, CI/CD, Automation]
---

前面幾個月專注在 iOS 開發的學習，現在是時候回到後端和部署的議題了。最近公司開始推動 DevOps 轉型，身為一個寫過 Java、JavaScript 和 Swift 的工程師，我發現不管是哪種語言，最後都會面臨同樣的問題：如何快速且穩定地將程式碼部署到生產環境？

## 我遇到的部署困境

上週部署一個簡單的 Spring Boot API 更新，整個過程讓我懷疑人生：

1. 本機執行 `mvn clean package` 打包（3 分鐘）
2. 用 SCP 把 JAR 檔傳到測試伺服器（1 分鐘）
3. SSH 登入伺服器，找到舊的 Java 行程並手動 kill
4. 備份舊的 JAR 檔
5. 啟動新的應用程式：`nohup java -jar app.jar &`
6. 查看 log 確認啟動成功
7. 發現忘記更新資料庫 schema... 從頭再來一次
8. 資料庫更新完，發現 application.properties 設定錯誤，又要重新部署

光是一個小更新就花了半小時，還不包含除錯的時間。更糟的是，每次部署流程都不太一樣，完全憑記憶和手寫的部署文件。

## Dev 和 Ops 的鴻溝

開發團隊和維運團隊就像活在平行時空：

**開發團隊的心聲：**
- 「在我本機跑得好好的啊！」
- 「這個功能很緊急，能不能快點部署？」
- 「為什麼部署要等這麼久？」

**維運團隊的心聲：**
- 「你們每次都說在本機沒問題，到伺服器就出事！」
- 「這週已經部署三次了，能不能一次搞定？」
- 「又要臨時加班部署了嗎？」

兩邊互相不理解，問題卻沒人能真正解決。

## DevOps 是什麼

DevOps 這個詞是 Development 和 Operations 的組合，但它不只是兩個詞拼起來這麼簡單。核心理念是打破開發和維運之間的牆，透過文化、實踐和工具的改變，讓整個軟體交付流程更快、更穩定。

簡單來說就是：
- **更快的交付速度**：從 commit 到上線，時間越短越好
- **更高的品質**：透過自動化測試減少人為錯誤
- **更快的恢復能力**：出問題能快速回滾
- **更好的協作**：開發和維運一起對產品負責

## DevOps 的核心實踐

### 1. 持續整合 (Continuous Integration, CI)

開發者頻繁地（至少每天一次）將程式碼整合到主幹，每次整合都透過自動化建置和測試來驗證。

在沒有 CI 之前，我們團隊的整合方式是：
- 每個人在自己的分支開發
- 開發到一半突然要整合，結果 merge conflict 一大堆
- 整合完才發現有人的程式碼根本跑不起來

有了 CI 之後，每次 push 都會自動：
1. 編譯程式碼
2. 執行單元測試
3. 執行整合測試
4. 產生報告

有問題立刻知道，不用等到最後才爆炸。

### 2. 持續交付 (Continuous Delivery, CD)

確保程式碼隨時處於可部署狀態。通過所有測試的程式碼，理論上可以隨時部署到生產環境（但可能需要人工批准）。

### 3. 基礎設施即程式碼 (Infrastructure as Code)

把伺服器、網路、資料庫等基礎設施的配置寫成程式碼，納入版本控制。就像我們寫應用程式碼一樣管理基礎設施。

### 4. 監控和日誌

持續監控應用程式和基礎設施的狀態，快速發現並解決問題。

## 開始學習的路徑

接下來幾週，我打算按照這個順序學習：

1. **Git 進階技巧**：分支策略、衝突處理、Git Flow
2. **Jenkins**：最普及的 CI/CD 工具
3. **Docker**：容器化應用程式
4. **Kubernetes**：容器編排
5. **監控工具**：Prometheus、Grafana
6. **日誌管理**：ELK Stack

這些工具在公司都有在用，先把基礎打好，之後遇到問題才知道怎麼處理。

## 心得

DevOps 不是單純學習幾個工具就夠了，更重要的是思維方式的轉變。以前寫完程式碼就覺得工作完成了，但現在要開始思考：

- 這段程式碼怎麼測試？
- 怎麼部署？
- 部署後怎麼監控？
- 出問題怎麼快速回滾？

把這些問題都考慮進去，才是真正的「負責任的開發」。

下週開始深入學習 Git 的進階使用，包括 Git Flow 和各種分支策略。
