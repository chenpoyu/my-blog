---
layout: post
title: "嘗試 Golang 的契機"
date: 2021-10-13
categories: [technology, golang]
tags: [Golang, 新技術]
---

「Poyu，客戶要求用 Golang 開發，但我們團隊沒人會啊！」

PM 很焦急地找我討論，我心裡也在掙扎。

一方面，這是團隊學習新技術的機會；  
另一方面，這是有交付期限的商業專案，失敗不起。

**這次決策，考驗的是我對「風險」和「成長」的權衡。**

## 專案背景

這是一個民間企業的內部系統，需求很明確：

- 處理大量檔案上傳和轉檔
- 需要高併發能力
- 部署要簡單（因為他們IT團隊很小）

客戶的技術顧問建議用 Golang，理由是：

1. **效能好** - 比 Java 快，比 C/C++ 好寫
2. **部署簡單** - 編譯成單一執行檔，不用裝 Runtime
3. **併發處理強** - Goroutine 天生適合這種場景

聽起來很合理。

**但問題是：我們團隊沒人會 Go。**

## 第一反應：拒絕

我的第一反應是拒絕：「我們不熟 Go，用 Java 或 C# 做會更穩。」

但PM說：「客戶堅持要 Go，因為他們內部也在學 Go，未來要自己維護。」

我問：「如果我們不接，會怎樣？」

「專案會給別家。」

這時我開始猶豫。

一方面，拒絕是安全的選擇，避免風險。  
另一方面，團隊已經抱怨「都在做一樣的東西，學不到新技術」。

**這不正是一個機會嗎？**

## 內部評估

我召集了幾位資深工程師討論：

**我：** 「有個專案要用 Go，你們有興趣嗎？」

**小陳（最資深）：** 「Go 我沒碰過，但一直想學。這個專案的難度如何？」

**我：** 「不算太難，主要是檔案處理和 API，但要有併發處理。時程三個月。」

**小李（Senior）：** 「三個月？我們要花多久學 Go？」

**我：** 「我想給兩週時間學基礎，然後邊做邊學。」

**小王（Mid）：** 「聽起來風險很高...如果做不出來怎麼辦？」

**我：** 「風險確實有，所以我想聽聽你們的意見。」

### 討論的結果

**支持的理由：**
- 學習新技術的機會
- Go 在業界越來越熱門
- 成功的話可以擴展技術棧

**擔心的地方：**
- 學習成本高
- 不確定能否如期交付
- 如果失敗，會影響團隊信心

最後我們做了一個決定：

**接這個專案，但要設定風險控管機制。**

## 風險控管計畫

### 1. 團隊組成

我不會讓全團隊都投入，而是：

- **核心成員（2人）：** 小陳、小李（資深，學習能力強）
- **支援成員（1人）：** 小王（Mid，有興趣學習）
- **後援計畫：** 如果真的不行，我可以調其他資深工程師支援

### 2. 學習階段（2週）

**Week 1：基礎學習**
- 每天2小時，學習 Go 基本語法
- 參考資源：Go by Example, Tour of Go
- 每天分享學習心得

**Week 2：小型專案**
- 用 Go 實作一個簡單的 API Server
- 包括：路由、資料庫存取、基本錯誤處理
- 確認團隊有能力開發

**評估標準：**
如果兩週後覺得「能做」，就繼續；如果覺得「風險太高」，就退回用 Java。

### 3. 開發階段（10週）

採用 **Agile + 短週期驗證**：

- **每週一次 demo** - 確認進度和品質
- **每兩週一次回顧** - 檢討問題和學習
- **隨時調整** - 如果卡關，馬上討論解決方案

### 4. 知識分享機制

要求核心成員：
- 寫學習筆記（放在 Wiki）
- 每週一次內部分享（讓其他人也學到）
- 建立 Best Practice 文件

目的：**不是只有這三個人會 Go，而是整個團隊都能學習。**

## 兩週後的結果

兩週學習期結束，我找他們聊：

**我：** 「感覺如何？能做嗎？」

**小陳：** 「Go 的語法很簡單，比 Java 簡潔很多。但併發處理的概念要習慣一下。」

**小李：** 「我覺得可以做，但可能需要更多時間除錯。Go 的錯誤處理跟 Java 很不一樣。」

**小王：** 「我還在適應，但有小陳和小李帶，應該沒問題。」

他們展示了一個簡單的 API Server：
- 能接收 HTTP 請求
- 能存取資料庫
- 能處理基本錯誤

**我的判斷：可以繼續。**

但我加了一個保險：
- 我會每週跟他們 1-on-1，確認狀況
- 如果發現問題，隨時喊停

## 開發過程的挑戰

### 挑戰一：併發處理的 Bug

第四週，小陳發現一個詭異的 bug：

「檔案上傳後，有時候會遺失資料。但不是每次都發生，很難重現。」

經過三天的 debug，發現是 **race condition** 問題。

**原因：** 多個 goroutine 同時存取同一個變數，沒有加鎖。

這在 Java 裡很常見，但 Go 的 goroutine 太輕量，很容易不小心就產生問題。

**解決方式：** 使用 `sync.Mutex` 加鎖，並且用 `go run -race` 檢測 race condition。

**這次經驗讓小陳說：**  
「Go 的併發很強大，但也很容易出錯。要更小心地設計。」

### 挑戰二：錯誤處理的煩躁

小李有次跟我抱怨：

「Go 的錯誤處理太煩了！每個 function 都要 `if err != nil`，寫到手軟。」

確實，Go 沒有 try-catch，所有錯誤都要顯式處理。

一開始團隊很不習慣，覺得「太囉嗦」。

但後來我們發現：**這反而讓錯誤處理更清楚。**

在 Java 裡，很多錯誤被 try-catch 吞掉，很難追蹤。  
在 Go 裡，每個錯誤都要處理，反而不容易遺漏。

**這改變了團隊對「錯誤處理」的認知。**

### 挑戰三：缺乏生態系

有次小王要實作一個功能，在 Java 裡用一個 library 就解決。

但在 Go 裡，找不到對應的 library，只能自己刻。

他很沮喪：「為什麼 Go 的生態系這麼差？」

我跟他說：「Go 比較年輕，生態系還在成長。而且 Go 的哲學是『簡單直接』，很多東西鼓勵你自己實作。」

這對習慣「用 library 解決一切」的 Java 工程師來說，是文化衝擊。

但換個角度想：**這也是學習的機會。**

自己實作，會更了解底層原理。

## 最後的成果

三個月後，專案如期交付。

**技術成果：**
- API Server 運作正常
- 效能確實比 Java 好（測試數據：快30%）
- 部署很簡單（一個執行檔+設定檔）

**團隊成果：**
- 三位工程師學會 Go
- 建立了 Go 開發的 Best Practice 文件
- 其他工程師也開始對 Go 有興趣

**客戶回饋：**
「效能和穩定性都很好，符合預期。」

**對我來說，最大的成果是：**

團隊不再害怕學新技術了。

## 反思

這次經驗讓我學到幾件事：

### 1. 風險可以管理

學新技術確實有風險，但不代表不能做。

關鍵是：**設定風險控管機制。**

- 評估階段（學習兩週）
- 小團隊試驗（不是全員投入）
- 短週期驗證（每週檢查）
- 退路準備（如果不行，改用熟悉技術）

### 2. 成長機會很珍貴

如果一直拒絕新技術，團隊會失去成長機會。

優秀的人會覺得「沒挑戰」，最終離開。

**適度的風險，是團隊成長的動力。**

### 3. 不是所有新技術都要追

這次接 Go 專案，是因為：
- 有實際需求（客戶要求）
- 有商業價值（專案收入）
- 符合技術趨勢（Go 在業界越來越熱）

如果只是「為了學而學」，沒有實際應用，很難持續。

**新技術要有「用武之地」，才有意義。**

### 4. 學習是團隊的事

這次不只三個人學 Go，而是整個團隊都參與：

- 核心成員開發
- 其他人透過分享會學習
- 文件讓後來者可以快速上手

**知識要流動，而不是封閉在少數人身上。**

## 後續發展

這次成功後，陸續又有兩個專案用 Go 開發。

現在團隊裡已經有七、八個人會 Go，形成一個小生態系。

**更重要的是：團隊對「學新技術」的態度改變了。**

以前大家會說：「這個沒用過，太危險。」  
現在大家會說：「這個有興趣，可以試試看。」

這種心態的轉變，比技術本身更有價值。

因為科技一直在變，今天的新技術，明天可能就過時了。

但**學習新技術的能力，會一直有用。**

而這次 Go 的經驗，讓團隊建立了這個能力。
